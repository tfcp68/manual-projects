Поликарпу недавно подарили перестановку A[1…n] длины n. Поликарпу деревья нравятся больше, чем перестановки, поэтому он хочет превратить перестановку A в корневое бинарное дерево. Массив различных целых чисел он превращает в дерево следующим образом:

- максимальный элемент массива становится корнем дерева;
- все элементы слева от максимума — образуют левое поддерево (которое строится по тем же правилам, но применяемым для левого участка массива), но если слева от максимума элементов нет, то у корня нет левого сына;
- все элементы справа от максимума — образуют правое поддерево (которое строится по тем же правилам, но применяемым для правого участка массива), но если справа от максимума элементов нет, то у корня нет правого сына.

Например, если он строит дерево по перестановке A = [3,5,2,1,4], то корнем будет элемент A[2] = 5, левым поддеревом будет дерево, которое будет построено для подмассива A[1…1] = [3], а правым — для подмассива A[3…5] = [2,1,4]. В итоге будет построено следующее дерево:

<div style="display:flex; align-items: center;"> 
	<div style="flex:1; mix-blend-mode:difference; filter:invert(1);"> 
		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264.3833527730694 447.8017508742405" width="264.3833527730694" height="447.8017508742405">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="264.3833527730694" height="447.8017508742405" fill="none"></rect><g stroke-linecap="round" transform="translate(68.42010805341761 9.999999999999886) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(9.999999999999545 129.06999122337504) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(135.75931657300316 125.50235103690693) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(80.46089368274716 253.93739774976132) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(191.05773946325962 344.91222250469986) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(137.98909168954606 305.2222254302414) rotate(0 30.324941584979342 24.973481305277232)"><path d="M0 0 C10.11 8.32, 50.54 41.62, 60.65 49.95 M0 0 C10.11 8.32, 50.54 41.62, 60.65 49.95" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(137.98909168954606 305.2222254302414) rotate(0 30.324941584979342 24.973481305277232)"><path d="M32.37 39.95 C39.37 42.42, 46.38 44.9, 60.65 49.95 M32.37 39.95 C41.56 43.2, 50.76 46.45, 60.65 49.95" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(137.98909168954606 305.2222254302414) rotate(0 30.324941584979342 24.973481305277232)"><path d="M45.41 24.11 C49.19 30.51, 52.96 36.91, 60.65 49.95 M45.41 24.11 C50.37 32.51, 55.32 40.91, 60.65 49.95" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(151.64345733512937 181.86176605878563) rotate(0 -12.835714795146941 36.84003169358539)"><path d="M0 0 C-4.28 12.28, -21.39 61.4, -25.67 73.68 M0 0 C-4.28 12.28, -21.39 61.4, -25.67 73.68" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(151.64345733512937 181.86176605878563) rotate(0 -12.835714795146941 36.84003169358539)"><path d="M-26.09 43.68 C-25.94 54.13, -25.8 64.59, -25.67 73.68 M-26.09 43.68 C-26 50.22, -25.91 56.75, -25.67 73.68" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(151.64345733512937 181.86176605878563) rotate(0 -12.835714795146941 36.84003169358539)"><path d="M-6.71 50.43 C-13.31 58.53, -19.92 66.63, -25.67 73.68 M-6.71 50.43 C-10.84 55.5, -14.97 60.56, -25.67 73.68" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(79.12302861282114 65.29842289025646) rotate(0 -12.04078562933023 32.108761678213625)"><path d="M0 0 C-4.01 10.7, -20.07 53.51, -24.08 64.22 M0 0 C-4.01 10.7, -20.07 53.51, -24.08 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(79.12302861282114 65.29842289025646) rotate(0 -12.04078562933023 32.108761678213625)"><path d="M-23.79 34.22 C-23.89 44.48, -23.99 54.75, -24.08 64.22 M-23.79 34.22 C-23.87 42.63, -23.95 51.04, -24.08 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(79.12302861282114 65.29842289025646) rotate(0 -12.04078562933023 32.108761678213625)"><path d="M-4.58 41.42 C-11.25 49.22, -17.92 57.02, -24.08 64.22 M-4.58 41.42 C-10.04 47.81, -15.51 54.2, -24.08 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(122.82662089705627 62.62269275040535) rotate(0 16.50033586241534 32.108761678213625)"><path d="M0 0 C5.5 10.7, 27.5 53.51, 33 64.22 M0 0 C5.5 10.7, 27.5 53.51, 33 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(122.82662089705627 62.62269275040535) rotate(0 16.50033586241534 32.108761678213625)"><path d="M10.99 43.83 C19.22 51.46, 27.46 59.08, 33 64.22 M10.99 43.83 C17.3 49.68, 23.61 55.52, 33 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(122.82662089705627 62.62269275040535) rotate(0 16.50033586241534 32.108761678213625)"><path d="M29.24 34.45 C30.65 45.59, 32.05 56.72, 33 64.22 M29.24 34.45 C30.32 42.99, 31.4 51.52, 33 64.22" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(215.43537025854766 394.6017508742405) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">1</text></g><g transform="translate(100.76585176636627 304.83113679451213) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">2</text></g><g transform="translate(156.06449598706058 174.7879485210459) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">4</text></g><g transform="translate(31.219214611764983 179.0036710180782) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">3</text></g><g transform="translate(89.65573529752737 60.593578624295674) rotate(0 10.546875 21.600000000000023)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">5</text></g></svg> 
	</div> 
</div>

Другой пример: пусть перестановка имеет вид A=[1,3,2,7,5,6,4]. В этом случае дерево выглядит так:

<div style="display:flex; align-items: center;"> 
	<div style="flex:1; mix-blend-mode:difference; filter:invert(1);"> 
		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 463.2380988500581 363.87929302154765" width="463.2380988500581" height="363.87929302154765">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <rect x="0" y="0" width="463.2380988500581" height="363.87929302154765" fill="none"></rect><g stroke-linecap="round" transform="translate(186.26067762936782 10) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(68.42776059982634 125.5723401019834) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(319.86801923770645 125.57234010198351) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round" transform="translate(264.56959634745044 255.8345031267035) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(335.7521599998331 181.86176605878575) rotate(0 -12.815675402172474 36.62124884971536)"><path d="M0 0 C-4.27 12.21, -21.36 61.04, -25.63 73.24 M0 0 C-4.27 12.21, -21.36 61.04, -25.63 73.24" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(335.7521599998331 181.86176605878575) rotate(0 -12.815675402172474 36.62124884971536)"><path d="M-26 43.24 C-25.88 53.24, -25.76 63.24, -25.63 73.24 M-26 43.24 C-25.88 53.5, -25.75 63.75, -25.63 73.24" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(335.7521599998331 181.86176605878575) rotate(0 -12.815675402172474 36.62124884971536)"><path d="M-6.63 50.02 C-12.97 57.76, -19.3 65.5, -25.63 73.24 M-6.63 50.02 C-13.13 57.96, -19.62 65.89, -25.63 73.24" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(191.51492208590298 58.70294407597828) rotate(0 -33.23181859961892 37.33602447419827)"><path d="M0 0 C-11.08 12.45, -55.39 62.23, -66.46 74.67 M0 0 C-11.08 12.45, -55.39 62.23, -66.46 74.67" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(191.51492208590298 58.70294407597828) rotate(0 -33.23181859961892 37.33602447419827)"><path d="M-55.39 46.79 C-58.88 55.6, -62.38 64.4, -66.46 74.67 M-55.39 46.79 C-58.51 54.66, -61.64 62.52, -66.46 74.67" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(191.51492208590298 58.70294407597828) rotate(0 -33.23181859961892 37.33602447419827)"><path d="M-40.06 60.44 C-48.4 64.93, -56.74 69.43, -66.46 74.67 M-40.06 60.44 C-47.51 64.45, -54.95 68.47, -66.46 74.67" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(245.24406817549516 56.931903194162714) rotate(0 42.092041661353505 37.974759804628036)"><path d="M0 0 C14.03 12.66, 70.15 63.29, 84.18 75.95 M0 0 C14.03 12.66, 70.15 63.29, 84.18 75.95" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(245.24406817549516 56.931903194162714) rotate(0 42.092041661353505 37.974759804628036)"><path d="M56.38 64.68 C64.22 67.86, 72.05 71.03, 84.18 75.95 M56.38 64.68 C65.01 68.18, 73.65 71.68, 84.18 75.95" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(245.24406817549516 56.931903194162714) rotate(0 42.092041661353505 37.974759804628036)"><path d="M70.13 49.45 C74.09 56.92, 78.05 64.39, 84.18 75.95 M70.13 49.45 C74.49 57.68, 78.86 65.91, 84.18 75.95" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(283.7320004122985 305.9736908132837) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">5</text></g><g transform="translate(340.17319865176387 174.78794852104602) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">6</text></g><g transform="translate(89.64697521159223 175.57600896176325) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">3</text></g><g transform="translate(207.49630487347804 60.59357862429579) rotate(0 10.546875 21.600000000000023)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">7</text></g><g stroke-linecap="round" transform="translate(389.9124855402483 255.8345031267035) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(373.55212780798684 180.1620648107737) rotate(0 18.295956554106624 37.164445142726834)"><path d="M0 0 C6.1 12.39, 30.49 61.94, 36.59 74.33 M0 0 C6.1 12.39, 30.49 61.94, 36.59 74.33" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(373.55212780798684 180.1620648107737) rotate(0 18.295956554106624 37.164445142726834)"><path d="M14.94 53.57 C21.75 60.11, 28.57 66.64, 36.59 74.33 M14.94 53.57 C22.86 61.17, 30.79 68.77, 36.59 74.33" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(373.55212780798684 180.1620648107737) rotate(0 18.295956554106624 37.164445142726834)"><path d="M33.35 44.5 C34.37 53.9, 35.39 63.29, 36.59 74.33 M33.35 44.5 C34.53 55.42, 35.72 66.34, 36.59 74.33" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(412.5027729918488 304.5967118170642) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">4</text></g><g stroke-linecap="round" transform="translate(10 255.8345031267035) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(81.18256365238267 181.74529308378374) rotate(0 -12.815675402172474 38.68785249968647)"><path d="M0 0 C-4.27 12.9, -21.36 64.48, -25.63 77.38 M0 0 C-4.27 12.9, -21.36 64.48, -25.63 77.38" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(81.18256365238267 181.74529308378374) rotate(0 -12.815675402172474 38.68785249968647)"><path d="M-26.51 47.39 C-26.28 55.25, -26.05 63.1, -25.63 77.38 M-26.51 47.39 C-26.31 54.27, -26.1 61.16, -25.63 77.38" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(81.18256365238267 181.74529308378374) rotate(0 -12.815675402172474 38.68785249968647)"><path d="M-7.03 53.84 C-11.9 60.01, -16.78 66.17, -25.63 77.38 M-7.03 53.84 C-11.3 59.24, -15.57 64.65, -25.63 77.38" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(29.16240406484758 310.67929302154766) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">1</text></g><g stroke-linecap="round" transform="translate(135.34288919279788 255.8345031267035) rotate(0 31.662806654904898 30.77089660828807)"><path d="M63.33 30.77 C63.33 32.55, 63.16 34.36, 62.84 36.11 C62.53 37.87, 62.04 39.62, 61.42 41.3 C60.79 42.97, 60 44.61, 59.08 46.16 C58.17 47.7, 57.1 49.19, 55.92 50.55 C54.74 51.91, 53.42 53.2, 52.02 54.34 C50.61 55.49, 49.08 56.53, 47.49 57.42 C45.91 58.31, 44.21 59.08, 42.49 59.69 C40.77 60.3, 38.97 60.77, 37.16 61.07 C35.36 61.38, 33.5 61.54, 31.66 61.54 C29.83 61.54, 27.97 61.38, 26.16 61.07 C24.36 60.77, 22.56 60.3, 20.83 59.69 C19.11 59.08, 17.42 58.31, 15.83 57.42 C14.24 56.53, 12.71 55.49, 11.31 54.34 C9.91 53.2, 8.59 51.91, 7.41 50.55 C6.23 49.19, 5.16 47.7, 4.24 46.16 C3.33 44.61, 2.54 42.97, 1.91 41.3 C1.28 39.62, 0.8 37.87, 0.48 36.11 C0.16 34.36, 0 32.55, 0 30.77 C0 28.99, 0.16 27.18, 0.48 25.43 C0.8 23.67, 1.28 21.92, 1.91 20.25 C2.54 18.57, 3.33 16.93, 4.24 15.39 C5.16 13.84, 6.23 12.36, 7.41 10.99 C8.59 9.63, 9.91 8.34, 11.31 7.2 C12.71 6.05, 14.24 5.01, 15.83 4.12 C17.42 3.23, 19.11 2.46, 20.83 1.86 C22.56 1.25, 24.36 0.78, 26.16 0.47 C27.97 0.16, 29.83 0, 31.66 0 C33.5 0, 35.36 0.16, 37.16 0.47 C38.97 0.78, 40.77 1.25, 42.49 1.86 C44.21 2.46, 45.91 3.23, 47.49 4.12 C49.08 5.01, 50.61 6.05, 52.02 7.2 C53.42 8.34, 54.74 9.63, 55.92 10.99 C57.1 12.36, 58.17 13.84, 59.08 15.39 C60 16.93, 60.79 18.57, 61.42 20.25 C62.04 21.92, 62.53 23.67, 62.84 25.43 C63.16 27.18, 63.25 29.88, 63.33 30.77 C63.41 31.66, 63.41 29.88, 63.33 30.77" stroke="#000000" stroke-width="4" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(117.60479569388963 182.11219548574275) rotate(0 18.984824437430234 38.54218090937428)"><path d="M0 0 C6.33 12.85, 31.64 64.24, 37.97 77.08 M0 0 C6.33 12.85, 31.64 64.24, 37.97 77.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(117.60479569388963 182.11219548574275) rotate(0 18.984824437430234 38.54218090937428)"><path d="M16.31 56.33 C24.55 64.23, 32.8 72.13, 37.97 77.08 M16.31 56.33 C24.9 64.56, 33.49 72.79, 37.97 77.08" stroke="#000000" stroke-width="4" fill="none"></path></g><g transform="translate(117.60479569388963 182.11219548574275) rotate(0 18.984824437430234 38.54218090937428)"><path d="M34.72 47.26 C35.96 58.61, 37.19 69.96, 37.97 77.08 M34.72 47.26 C36.01 59.09, 37.3 70.92, 37.97 77.08" stroke="#000000" stroke-width="4" fill="none"></path></g></g><mask></mask><g transform="translate(157.93317664439837 309.3023140253281) rotate(0 10.546875 21.599999999999994)"><text x="0" y="0" font-family="Cascadia, Segoe UI Emoji" font-size="36px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">2</text></g></svg>
	</div> 
</div>
Обозначим за d[v] глубину вершины A[v], то есть количество ребер на пути от корня до вершины с номером A[v]. Заметьте, что глубина корня равна нулю. По заданной перестановке A для каждой вершины найдите значение d[v].

---

Будем рекурсивно строить дерево: первый этап находим корень/максимум и удаляем его из текущего массива. Далее делим массив на левую и правую части. 
Если длина левой части больше 0, тогда добавляем связь корня с максимумом левой части и продолжаем строить дерево от левой части. 
Аналогично поступаем с правой частью.

После построения дерева, необходимо найти глубины вершин. Искать их будем поиском в ширину. Создадим массив глубин. По умолчанию глубина корня дерева = 0, а глубина остальных вершин = число вершин дерева + 1. Далее обходим граф: если глубина вершины < глубина её соседа, тогда глубина соседа = глубина вершины + 1. 

Осталось только вывести результат вычислений в нужном порядке.

#### Псевдокод
```
Функция build_tree(перестанвока)
	корень <- максимальный элемент перестановки
	удалить корень из перестановки

	left <- часть массива перед корнем
	right <- часть массива после корня

	если левая часть не пуста
		то добавляем связь корня с max элементом left
		   строим дерево от left

	если правая часть не пуста
		то добавляем связь корня с max элементом right
		   строим дерево от right

	вернуть дерево


Функция bfs(tree):
	создать массив глубин
	заполнить массив бесконечностями
	глубина первой вершины <- 0

	создать очередь
	пока очередь непуста
	u <- первый элемент очереди
    удалить u из очереди
    перебираем всех соседей u
	    если глубина соседа > глубина u + 1
		    то глубина соседа <- глубина u + 1
		       добавляем соседа в очередь

	вернуть массив глубин
```

#### Реализация на Python
```python
def build_tree(arr: list, tree):  
    root = max(arr)  
    index_root = arr.index(root)  
    arr.remove(root)  
  
    left = arr[:index_root]  
    right = arr[index_root:]  
  
    if len(left) > 0:  
        tree[root].append(max(left))  
        build_tree(left, tree)  
  
    if len(right) > 0:  
        tree[root].append(max(right))  
        build_tree(right, tree)  
  
    return tree  
  
  
def bfs(graph, start):  
    deeps = [math.inf] * (len(graph) + 1)  
    deeps[start] = 0
      
    queue = deque()  
    queue.append(start)  
  
    while queue:  
        node = queue.popleft()  
        for neighbour in graph[node]:  
            if deeps[neighbour] > deeps[node] + 1:  
                deeps[neighbour] = deeps[node] + 1  
                queue.append(neighbour)  
  
    return deeps  
  
  
def solve():  
    n = int(input())  
  
    arr = list(map(int, input().split()))  
  
    start = max(arr)  
  
    tree = {}  
    for i in arr:  
        tree[i] = []  
  
    build_tree(arr, tree)  
    deeps = bfs(tree, start)  
  
    for i in tree:  
        print(deeps[i], end=' ')  
    print()  
    return
```

#### Production C++
```cpp
std::map<int, std::vector<int>> 
build_tree(std::vector<int> array, 
		   std::map<int, std::vector<int>>& tree) {
    int root = *std::max_element(array.begin(), array.end());
    
    std::vector<int>::iterator 
    itr = std::find(array.begin(), array.end(), root);
    
    int index_root = std::distance(array.begin(), itr);
    array.erase(array.begin() + index_root);

    std::vector<int> left;
    std::vector<int> right;

    left.insert(left.end(), array.begin(), 
		        array.begin() + index_root);
    right.insert(right.end(), 
			     array.begin() + index_root, array.end());

    if (left.size() > 0) {
        int new_root = *std::max_element(left.begin(), left.end());
        tree[root].push_back(new_root);
        build_tree(left, tree);
    }

    if (right.size() > 0) {
        int new_root = *std::max_element(right.begin(), 
							             right.end());
        tree[root].push_back(new_root);
        build_tree(right, tree);
    }
    return tree;
}


std::vector<int> 
bfs(std::map<int, std::vector<int>> graph, int start) {
    std::vector<int> deeps(graph.size() + 1, graph.size());
    deeps[start] = 0;
    std::queue<int> queue;
    queue.push(start);

    while (queue.empty() != 1) {
        int node = queue.front();
        queue.pop();

        for (int neighbour : graph[node]) {
            if (deeps[neighbour] > deeps[node] + 1) {
                deeps[neighbour] = deeps[node] + 1;
                queue.push(neighbour);
            }
        }
    }
    return deeps;
}


void solve() {
    int len_permutation;
    std::cin >> len_permutation;

    std::vector<int> permutation;
    for (int i = 0; i < len_permutation; i++) {
        int digit;
        std::cin >> digit;
        permutation.push_back(digit);
    }

    int start = *std::max_element(permutation.begin(), 
							      permutation.end());

    std::map<int, std::vector<int>> tree;
    for (int i : permutation) {
        std::vector<int> v;
        tree[i] = v;
    }

    build_tree(permutation, tree);

    std::vector<int> deeps = bfs(tree, start);

    for (int i : permutation) {
        std::cout << deeps[i] << " ";
    }
    std::cout << std::endl;
}
```
#### Olympic C++
```cpp
typedef vector<int> vi;
typedef map<int, vector<int>> map_ivi;


map_ivi build_tree(vi arr, map_ivi& tree) {
    int root = *max_element(arr.begin(), arr.end());
    
    vi::iterator itr = find(arr.begin(), arr.end(), root);
    
    int i_root = distance(array.begin(), itr);
    arr.erase(arr.begin() + i_root);

    vi l; 
    vi r;

    l.insert(l.end(), arr.begin(), arr.begin() + i_root);
    r.insert(r.end(), arr.begin() + index_root, arr.end());

    if (l.size() > 0) {
        int new_root = *max_element(l.begin(), l.end());
        tree[root].push_back(new_root);
        build_tree(l, tree);
    }

    if (r.size() > 0) {
        int new_root = *max_element(r.begin(), r.end());
        tree[root].push_back(new_root);
        build_tree(r, tree);
    }
    
    return tree;
}


vi bfs(map_ivi graph, int start) {
    vi d(graph.size() + 1, graph.size());
    d[start] = 0;
    queue<int> q;
    q.push(start);

    while (q.empty() != 1) {
        int node = q.front();
        q.pop();

        for (int i : graph[node]) {
            if (d[i] > d[node] + 1) {
                d[i] = d[node] + 1;
                q.push(i);
            }
        }
    }
    return deeps;
}


void solve() {
    int n;
    std::cin >> n;

    std::vector<int> a;
    for (int i = 0; i < n; i++) {
        int digit;
        std::cin >> digit;
        a.push_back(digit);
    }

    int start = *max_element(a.begin(), a.end());

    map_ivi tree;
    for (int i : a) {
        vi v;
        tree[i] = v;
    }

    build_tree(a, tree);

    vi d = bfs(tree, start);

    for (int i : a) {
        cout << d[i] << " ";
    }
    cout << endl;
}
